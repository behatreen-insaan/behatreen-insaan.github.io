<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CV Builder</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/docx@7.5.0/build/index.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.tiny.cloud/1/hk4nb8y38mlhe25ff58ya0ayvywzctp39caeutkzjqp3ws4g/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 800px;
      margin: auto;
      background: #f8f9fa;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 20px;
    }
    textarea, input {
      width: 100%;
      margin-top: 8px;
      padding: 10px;
      font-size: 14px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    .row {
      display: flex;
      gap: 10px;
    }
    .row input {
      flex: 1;
    }
    button {
      padding: 10px 20px;
      margin: 20px 10px 0 0;
      cursor: pointer;
      font-size: 14px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
    }
    button:hover {
      background-color: #0056b3;
    }
    .dynamic-group {
      margin-top: 15px;
      border: 1px solid #ccc;
      padding: 15px;
      border-radius: 5px;
      background: white;
    }
    .remove-btn {
      margin-top: 10px;
      background-color: #dc3545;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 3px;
      cursor: pointer;
      font-size: 12px;
    }
    .remove-btn:hover {
      background-color: #c82333;
    }
  </style>
</head>
<body>
  <h1>CV Builder</h1>

  <!-- Personal Details -->
  <label>Name:</label>
  <input type="text" id="name">

  <label>Contact Number:</label>
  <div class="row">
    <input type="text" placeholder="+91" id="countryCode" style="max-width: 80px">
    <input type="text" placeholder="1234567890" id="contact">
  </div>

  <label>Email:</label>
  <input type="email" id="email">

  <label>LinkedIn:</label>
  <input type="text" id="linkedin">

  <label>Professional Summary:</label>
  <textarea id="summary"></textarea>

  <!-- Work Experience -->
  <label>Work Experience:</label>
  <div id="experience-container"></div>
  <button type="button" onclick="addExperience()">+ Add Experience</button>

  <!-- Education -->
  <label>Education:</label>
  <div id="education-container"></div>
  <button type="button" onclick="addEducation()">+ Add Education</button>

  <label>Skills:</label>
  <textarea id="skills"></textarea>

  <label>Certifications:</label>
  <textarea id="certifications"></textarea>

  <label>Projects:</label>
  <textarea id="projects"></textarea>

  <button onclick="generateDoc()">Save as DOCX</button>
  <button onclick="generatePDF()">Save as PDF</button>

  <script>
    // Add Work Experience Section
    function addExperience() {
      const container = document.getElementById('experience-container');
      const id = `experience-${Date.now()}`;
      const div = document.createElement('div');
      div.className = 'dynamic-group';
      div.innerHTML = `
        <label>Title:</label>
        <input type="text" id="${id}-title" />

        <label>Company Name:</label>
        <input type="text" id="${id}-company" />

        <label>From Date:</label>
        <input type="date" id="${id}-from" />

        <label>To Date:</label>
        <input type="date" id="${id}-to" />

        <label>Details:</label>
        <textarea id="${id}-details"></textarea>
        <button type="button" class="remove-btn" onclick="removeSection(this)">Remove</button>
      `;
      container.appendChild(div);
      initTiny(`${id}-details`);
    }

    // Add Education Section
    function addEducation() {
      const container = document.getElementById('education-container');
      const id = `education-${Date.now()}`;
      const div = document.createElement('div');
      div.className = 'dynamic-group';
      div.innerHTML = `
        <label>Institute Name:</label>
        <input type="text" id="${id}-institute" />

        <label>Degree:</label>
        <input type="text" id="${id}-degree" />

        <label>From Date:</label>
        <input type="date" id="${id}-from" />

        <label>To Date:</label>
        <input type="date" id="${id}-to" />

        <button type="button" class="remove-btn" onclick="removeSection(this)">Remove</button>
      `;
      container.appendChild(div);
    }

    // Remove Dynamic Section
    function removeSection(button) {
      const container = button.parentElement;
      const textarea = container.querySelector('textarea');
      if (textarea && tinymce.get(textarea.id)) {
        tinymce.get(textarea.id).remove();
      }
      container.remove();
    }

    // Initialize TinyMCE for a given textarea
    function initTiny(id) {
      tinymce.init({
        selector: `#${id}`,
        menubar: false,
        plugins: 'lists link',
        toolbar: 'bold italic underline | bullist numlist | link',
        setup: (editor) => {
          editor.on('change', () => {
            editor.save();
          });
        }
      });
    }

    // Gather all input values and generate a DOCX file
    function generateDoc() {
      const name = document.getElementById("name").value;
      const contact = document.getElementById("contact").value;
      const countryCode = document.getElementById("countryCode").value;
      const email = document.getElementById("email").value;
      const linkedin = document.getElementById("linkedin").value;
      const summary = tinymce.get("summary").getContent();

      const skills = tinymce.get("skills").getContent();
      const certifications = tinymce.get("certifications").getContent();
      const projects = tinymce.get("projects").getContent();

      const workExperiences = [];
      document.querySelectorAll("#experience-container .dynamic-group").forEach((group) => {
        const title = group.querySelector('input[id$="-title"]').value;
        const company = group.querySelector('input[id$="-company"]').value;
        const from = group.querySelector('input[id$="-from"]').value;
        const to = group.querySelector('input[id$="-to"]').value;
        const details = tinymce.get(group.querySelector('textarea').id).getContent();
        workExperiences.push(`Title: ${title}, Company: ${company}, From: ${from}, To: ${to}, Details: ${details}`);
      });

      const educations = [];
      document.querySelectorAll("#education-container .dynamic-group").forEach((group) => {
        const institute = group.querySelector('input[id$="-institute"]').value;
        const degree = group.querySelector('input[id$="-degree"]').value;
        const from = group.querySelector('input[id$="-from"]').value;
        const to = group.querySelector('input[id$="-to"]').value;
        educations.push(`Institute: ${institute}, Degree: ${degree}, From: ${from}, To: ${to}`);
      });

      const doc = new docx.Document({
        sections: [
          {
            children: [
              new docx.Paragraph({ text: `Name: ${name}`, bold: true }),
              new docx.Paragraph({ text: `Contact: ${countryCode} ${contact}` }),
              new docx.Paragraph({ text: `Email: ${email}` }),
              new docx.Paragraph({ text: `LinkedIn: ${linkedin}` }),
              new docx.Paragraph({ text: "Professional Summary:", bold: true }),
              new docx.Paragraph({ text: summary }),
              new docx.Paragraph({ text: "Skills:", bold: true }),
              new docx.Paragraph({ text: skills }),
              new docx.Paragraph({ text: "Certifications:", bold: true }),
              new docx.Paragraph({ text: certifications }),
              new docx.Paragraph({ text: "Projects:", bold: true }),
              new docx.Paragraph({ text: projects }),
              new docx.Paragraph({ text: "Work Experience:", bold: true }),
              ...workExperiences.map((exp) => new docx.Paragraph({ text: exp })),
              new docx.Paragraph({ text: "Education:", bold: true }),
              ...educations.map((edu) => new docx.Paragraph({ text: edu })),
            ],
          },
        ],
      });

      docx.Packer.toBlob(doc).then((blob) => {
        saveAs(blob, "CV.docx");
      });
    }
  </script>
</body>
</html>